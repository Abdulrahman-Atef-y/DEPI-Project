@model IEnumerable<Hotel_Management_System.Models.DTOs.RoomTypeDTO>

@{
    ViewData["Title"] = "الرئيسية";
}

<section class="hero-section">
    <div class="hero-image">
        @{
            var heroImages = new[] { "HeroImage.png", "HeroImage1.png" };
            var randomImage = heroImages[new Random().Next(heroImages.Length)];
        }
        <img src="@Url.Content($"~/Heroimg/{randomImage}")" alt="Grand Hotel" style="width:100%; height:60vh; object-fit:cover;">   
        <div class="hero-overlay"></div>
        <div class="hero-content">
            <h1 class="hero-title">جراند هوتيل</h1>
            <p class="hero-subtitle">فندق 5 نجوم - تجربة فندقية استثنائية</p>
            <a asp-controller="Rooms" asp-action="Index" class="cta-button">
                <span>استعرض الغرف</span>
                <i class="fas fa-arrow-left"></i>
            </a>
        </div>
    </div>
</section>
<section class="rooms-section" style="padding: 100px 0;">
    <div class="container">
        <h2 class="section-title text-center mb-5">غرفنا المميزة</h2>
        <p class="section-subtitle">إقامة فاخرة تناسب جميع الاحتياجات</p>

        <div class="rooms-grid">
            @if (Model != null && Model.Any())
            {
            @foreach (var roomType in Model.Take(4))
            {
                @* <div class="room-card">
                    <div class="room-image">
                            <div class="carousel-container">
                                <img id="mainImage-@roomType.Id" src="@(roomType.ImageUrls.FirstOrDefault() ?? "https://via.placeholder.com/800x600?text=No+Image")" alt="@roomType.Name">

                                <button class="gallery-nav prev" onclick="prevImage(@roomType.Id)">&#10094;</button>
                                <button class="gallery-nav next" onclick="nextImage(@roomType.Id)">&#10095;</button>

                                <div class="image-counter" id="counter-@roomType.Id">1 / @roomType.ImageUrls.Count</div>
                                <div class="room-overlay">
                                    <div class="room-price">@roomType.Price.ToString("C") / ليلة</div>
                                </div>
                            </div>
       
                    </div>
                    <div class="room-content">
                            <h3 class="room-title">@roomType.Name</h3>
                            <p class="room-description">@(roomType.Description?.Length > 100 ? roomType.Description.Substring(0, 100) + "..." : roomType.Description)</p>
                        <div class="room-features">
                                <span><i class="fas fa-users"></i> @roomType.Occupancy أشخاص</span>
                        </div>
                        <div class="room-actions mt-3">
                                <a asp-controller="Booking" asp-action="Create" asp-route-roomTypeId="@roomType.Id" class="btn-book btn-primary w-100">
                                <i class="fas fa-calendar-check"></i> احجز الآن
                            </a>
                        </div>
                    </div>
                </div> *@



                    <div class="room-card">
                        <div class="room-image">
                            <img id="mainImage-@roomType.Id"
                                 src="@(roomType.ImageUrls.FirstOrDefault() ?? "https://via.placeholder.com/800x600?text=No+Image")"
                                 alt="@roomType.Name" />

                            <div class="room-overlay">
                                <div class="room-price">
                                    @roomType.Price.ToString("C") / ليلة
                                </div>
                            </div>

                            <button class="quick-book"
                                    onclick="startQuickBook(@roomType.Id)">
                                <i class="fas fa-plus"></i>
                            </button>
                        </div>

                        <div class="room-content">
                            <h3 class="room-title">@roomType.Name</h3>

                            <p class="room-description">
                                @(roomType.Description?.Length > 100
                                                        ? roomType.Description.Substring(0, 100) + "..."
                                                        : roomType.Description)
                    </p>

                            <div class="room-features">
                                <span>
                                    <i class="fas fa-users"></i>
                                    @roomType.Occupancy أشخاص
                                </span>

                                <span>
                                    <i class="fas fa-expand"></i>
                                    5 م²
                                </span>

                                <span class="room-rating">
                                    <i class="fas fa-star"></i>
                                    5
                                </span>
                            </div>

                            <div class="room-actions">
                                <a class="btn-details"
                                   asp-controller="Rooms" asp-action="Details" asp-route-id="@roomType.Id">
                                    <i class="fas fa-eye"></i>
                                    عرض التفاصيل
                                </a>

                                <a asp-controller="Booking"
                                   asp-action="Create"
                                   asp-route-roomTypeId="@roomType.Id"
                                   class="btn-book btn-primary">
                                    <i class="fas fa-calendar-check"></i>
                                    احجز الآن
                                </a>
                            </div>
                        </div>
                    </div>





            }
            }
            else
            {
                <div class="no-data">
                    <i class="fas fa-bed"></i>
                    <p>الرجاء إضافة أنواع غرف من لوحة التحكم لتظهر هنا.</p>
                </div>
            }
        </div>
    </div>
</section>
@section Scripts {
    <script>
        const roomImages = @Html.Raw(System.Text.Json.JsonSerializer.Serialize(
        Model?.ToDictionary(r => r.Id, r => r.ImageUrls) ?? new Dictionary<int, List<string>>()
        ));
        const currentIndex = {};
        Object.keys(roomImages).forEach(id => currentIndex[id] = 0);

        function showImage(roomId) {
            const imgs = roomImages[roomId];
            const index = currentIndex[roomId];
            document.getElementById('mainImage-' + roomId).src = imgs[index];
            document.getElementById('counter-' + roomId).innerText = (index + 1) + ' / ' + imgs.length;
        }

        function nextImage(roomId) {
            currentIndex[roomId]++;
            if (currentIndex[roomId] >= roomImages[roomId].length) currentIndex[roomId] = 0;
            showImage(roomId);
        }

        function prevImage(roomId) {
            currentIndex[roomId]--;
            if (currentIndex[roomId] < 0) currentIndex[roomId] = roomImages[roomId].length - 1;
            showImage(roomId);
        }
    </script>
}